SHOW DATABASES;
CREATE DATABASE IF NOT EXISTS OFFICE;
USE OFFICE;

CREATE TABLE DEPT (
    DEPTNO INT PRIMARY KEY,
    DNAME VARCHAR(50),
    DLOC VARCHAR(50)
);

CREATE TABLE JOB_ROLE (
    JOB_ROLE VARCHAR(50) PRIMARY KEY
);


CREATE TABLE EMPLOYEE (
    EMPNO INT PRIMARY KEY,
    ENAME VARCHAR(50),
    MGR_NO INT,
    HIREDATE DATE,
    SAL DECIMAL(10,2),
    DEPTNO INT,
    JOB_ROLE VARCHAR(50),
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO),
    FOREIGN KEY (JOB_ROLE) REFERENCES JOB_ROLE(JOB_ROLE)
);


CREATE TABLE PROJECT (
    PNO INT PRIMARY KEY,
    PNAME VARCHAR(50),
    PLOC VARCHAR(50)
);


CREATE TABLE ASSIGNED_TO (
    EMPNO INT,
    PNO INT,
    PRIMARY KEY (EMPNO, PNO),
    FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO),
    FOREIGN KEY (PNO) REFERENCES PROJECT(PNO)
);


CREATE TABLE INCENTIVES (
    EMPNO INT,
    INCENTIVE_DATE DATE,
    INCENTIVE_AMOUNT DECIMAL(10,2),
    PRIMARY KEY (EMPNO, INCENTIVE_DATE),
    FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO)
);


INSERT INTO DEPT VALUES
(10, 'Engineering', 'Bengaluru'),
(20, 'Marketing', 'Hyderabad'),
(30, 'HR', 'Mysuru'),
(40, 'Finance', 'Chennai'),
(50, 'Operations', 'Delhi'),
(60, 'Support', 'Bengaluru');

SELECT * FROM DEPT;


INSERT INTO JOB_ROLE VALUES
('Developer'),
('Analyst'),
('Manager'),
('HR Executive'),
('Accountant'),
('Support Engineer');

SELECT * FROM JOB_ROLE;


INSERT INTO EMPLOYEE VALUES
(101, 'Anita', NULL, '2022-01-10', 60000, 10, 'Developer'),
(102, 'Ravi', 101, '2021-03-15', 55000, 20, 'Analyst'),
(103, 'Meena', 101, '2023-06-01', 50000, 30, 'HR Executive'),
(104, 'Kiran', 102, '2020-11-20', 70000, 10, 'Manager'),
(105, 'Suresh', NULL, '2022-07-25', 48000, 40, 'Accountant'),
(106, 'Divya', 104, '2023-02-12', 52000, 60, 'Support Engineer');

SELECT * FROM EMPLOYEE;


INSERT INTO PROJECT VALUES
(201, 'CampusConnect', 'Bengaluru'),
(202, 'AdBoost', 'Hyderabad'),
(203, 'HRMS', 'Mysuru'),
(204, 'FinTrack', 'Chennai'),
(205, 'OpsSuite', 'Delhi'),
(206, 'HelpDesk', 'Bengaluru');

SELECT * FROM PROJECT;


INSERT INTO ASSIGNED_TO VALUES
(101, 201),
(102, 202),
(103, 203),
(104, 201),
(105, 204),
(106, 206),
(101, 206),
(104, 206);

SELECT * FROM ASSIGNED_TO ;

INSERT INTO INCENTIVES VALUES
(101, '2023-08-01', 5000),
(102, '2023-07-15', 3000),
(104, '2023-09-10', 4500),
(106, '2023-06-20', 4000),
(101, '2023-10-01', 2500),
(102, '2023-10-05', 3500);

SELECT * FROM INCENTIVES;

SELECT DISTINCT A.EMPNO
FROM ASSIGNED_TO A
JOIN PROJECT P ON A.PNO = P.PNO
WHERE P.PLOC IN ('Bengaluru', 'Hyderabad', 'Mysuru');

SELECT EMPNO
FROM EMPLOYEE
WHERE EMPNO NOT IN (
    SELECT DISTINCT EMPNO FROM INCENTIVES
);

SELECT E.EMPNO, E.ENAME, E.DEPTNO, E.JOB_ROLE, D.DLOC AS DEPT_LOC, P.PLOC AS PROJECT_LOC
FROM EMPLOYEE E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
JOIN ASSIGNED_TO A ON E.EMPNO = A.EMPNO
JOIN PROJECT P ON A.PNO = P.PNO
WHERE D.DLOC = P.PLOC;
